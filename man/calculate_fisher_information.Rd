% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/score_functions.R
\name{calculate_fisher_information}
\alias{calculate_fisher_information}
\title{Calculate Fisher Information matrix using Gauss-Hermite quadrature}
\usage{
calculate_fisher_information(mu, sigma2, X_t_prev, p_trans, gh_setup, K)
}
\arguments{
\item{mu}{Vector of regime means (length K)}

\item{sigma2}{Vector of regime variances (length K)}

\item{X_t_prev}{Previous filtered probabilities (length K)}

\item{p_trans}{Current transition probabilities (length K*(K-1))}

\item{gh_setup}{Gauss-Hermite quadrature setup from setup_gauss_hermite_quadrature()}

\item{K}{Number of regimes}
}
\value{
Fisher Information value (scalar)
}
\description{
Calculate Fisher Information matrix using Gauss-Hermite quadrature
}
\details{
Calculates the Fisher Information matrix for the GAS model using numerical
integration via Gauss-Hermite quadrature. Following the methodology in
Bazzi et al. (2017), this involves integrating the squared score function
over all possible values of y_t.

The Fisher Information is used for scaling the score vector to ensure
proper statistical properties. Since the matrix is singular by design
(as noted in Bazzi et al.), we compute a scalar measure that captures
the overall information content.

The integration follows the original 2-regime implementation:
I = ∫ [(d1-d2)²/den] * φ(y; μ_quad, σ_quad²) dy

where d1, d2 are regime densities and den is the total density.
}
\examples{
\dontrun{
# Setup quadrature and calculate Fisher Information
y <- rnorm(1000)
gh_setup <- setup_gauss_hermite_quadrature(y)

K <- 3
mu <- c(-1, 0, 1)
sigma2 <- c(0.5, 1, 1.5)
X_t_prev <- c(0.3, 0.4, 0.3)
p_trans <- rep(0.2, 6)

fisher_info <- calculate_fisher_information(mu, sigma2, X_t_prev, p_trans, gh_setup, K)
}
}
