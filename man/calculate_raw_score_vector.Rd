% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/score_functions.R
\name{calculate_raw_score_vector}
\alias{calculate_raw_score_vector}
\title{Calculate raw score vector for GAS model}
\usage{
calculate_raw_score_vector(eta, tot_lik, X_t_prev, p_trans, K)
}
\arguments{
\item{eta}{Vector of regime likelihoods at time t (length K)}

\item{tot_lik}{Total likelihood at time t (scalar)}

\item{X_t_prev}{Filtered probabilities from previous time step (length K)}

\item{p_trans}{Current transition parameters (length K*(K-1)). These are
unconstrained softmax parameters when using off-diagonal parameterization.}

\item{K}{Number of regimes}
}
\value{
Raw score vector (length K*(K-1))
}
\description{
Calculate raw score vector for GAS model
}
\details{
Implements the GAS score for K regimes using softmax parameterization.

For off-diagonal softmax parameters x_ij, the score is derived via the chain
rule through the softmax Jacobian:
\deqn{d \log L / d x_{ij} = X_{t-1,i} \cdot P_{ij} \cdot (\eta_j - \text{row\_lik}_i) / \text{tot\_lik}}
where \eqn{\text{row\_lik}_i = \sum_m \eta_m \cdot P_{im}}.

For a K-regime model, we have K*(K-1) softmax parameters (off-diagonal
elements of the transition matrix), so the score vector has K*(K-1) elements.
}
\examples{
\dontrun{
# Calculate raw score for a 3-regime model
K <- 3
eta <- c(0.1, 0.8, 0.1)  # Regime likelihoods
tot_lik <- sum(eta * c(0.3, 0.4, 0.3))  # Total likelihood
X_t_prev <- c(0.3, 0.4, 0.3)  # Previous filtered probabilities
p_trans <- rep(0, 6)  # Softmax parameters (0 = equal probs)

raw_score <- calculate_raw_score_vector(eta, tot_lik, X_t_prev, p_trans, K)
}
}
