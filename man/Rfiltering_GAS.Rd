% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model_GAS.R
\name{Rfiltering_GAS}
\alias{Rfiltering_GAS}
\title{Filter observed data through the score-driven (GAS) regime-switching model}
\usage{
Rfiltering_GAS(
  par,
  y,
  B_burnin,
  C,
  n_nodes = 30,
  scaling_method = NULL,
  use_fallback = TRUE,
  A_threshold = 1e-04,
  diagnostics = FALSE,
  verbose = FALSE
)
}
\arguments{
\item{par}{Parameter vector with attributes (mu, sigma2, init_trans, A, B)}

\item{y}{Observed time series increments}

\item{B_burnin}{Burn-in to be excluded at the beginning of the time series}

\item{C}{Cut-off to be excluded at the end of the time series}

\item{n_nodes}{Number of Gauss-Hermite quadrature nodes (default: 30)}

\item{scaling_method}{Score scaling method ("moore_penrose", "simple", "normalized", or "factored")}

\item{use_fallback}{Whether to automatically use constant model fallback when A is small (default: TRUE)}

\item{A_threshold}{Threshold below which to use constant model fallback (default: 1e-4)}

\item{diagnostics}{If TRUE, include detailed diagnostic information (default: FALSE)}

\item{verbose}{Whether to report fallback usage (default: FALSE)}
}
\value{
Negative log-likelihood of observed data under the model
}
\description{
Filter observed data through the score-driven (GAS) regime-switching model
}
\details{
Automatically reads configuration (diagonal vs off-diagonal, equal variances)
from parameter attributes.

Filters observed data through the model to compute the likelihood using proper
GAS score scaling following Bazzi et al. (2017). When use_fallback=TRUE,
automatically falls back to constant transition probability model when A parameters
are effectively zero, providing both speed improvements and numerical stability.

The diagnostics parameter controls whether detailed information is attached
as attributes (expensive during optimization, useful for final results).
}
\examples{
# Filter data using diagonal parameterization
par_diag <- c(-1, 1, 0.5, 0.6, 0.8, 0.9, 0.1, 0.2, 0.8, 0.9)
par_diag <- set_parameter_attributes(par_diag, K=2, model_type="gas",
                                     diag_probs=TRUE, equal_variances=FALSE)
y <- rnorm(200)
loglik <- Rfiltering_GAS(par_diag, y, 20, 10)
}
