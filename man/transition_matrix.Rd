% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/transition_helpers.R
\name{transition_matrix}
\alias{transition_matrix}
\title{Transition Matrix Helper Functions for Multi-Regime TVTP Models}
\usage{
transition_matrix(probs, diag_probs = TRUE, check_validity = TRUE)
}
\arguments{
\item{probs}{Vector of transition probability parameters}

\item{diag_probs}{If TRUE, probs contains diagonal elements; if FALSE, off-diagonal elements}

\item{check_validity}{Logical; whether to validate the resulting matrix (default: TRUE)}
}
\value{
A properly formatted Markov transition matrix
}
\description{
This file provides functions for creating and manipulating transition matrices
with support for both diagonal and off-diagonal parameterizations.
}
\section{DIAGONAL VS OFF-DIAGONAL PARAMETERIZATIONS:}{
DIAGONAL PARAMETERIZATION (diag_probs = TRUE) [DEFAULT]:
\itemize{
\item Uses K parameters representing diagonal elements p_11, p_22, ..., p_KK
\item Off-diagonal elements equal within each row: p_ij = (1-p_ii)/(K-1) for iâ‰ j
\item Compatible with original HMMGAS/simulation.R implementation
\item For K=2: [p11, p22] -> matrix [[p11, 1-p11], [1-p22, p22]]
\item For K=3: [p11, p22, p33] -> matrix with equal off-diagonal probabilities per row
\item IMPORTANT FOR K>2: This parameterization assumes that when leaving a state,
the probability of transitioning to any other state is uniform. This is a
modeling simplification that reduces parameters but may not fit all data.
}

OFF-DIAGONAL PARAMETERIZATION (diag_probs = FALSE):
\itemize{
\item Uses K*(K-1) parameters representing all off-diagonal elements p_ij (i!=j)
\item Diagonal elements calculated as: p_ii = 1 - sum(p_ij for j!=i)
\item Allows arbitrary transition structures between states
\item For K=2: [p12, p21] -> matrix [[p11, p12], [p21, p22]] where p11=1-p12, p22=1-p21
\item More flexible but requires more parameters to estimate
}

This dual system allows validation against the original implementation while
maintaining flexibility for K>2 regime models with complex transition dynamics.
Create a transition matrix from probability parameters

This is the main function for creating transition matrices. It automatically
determines the parameterization and creates the appropriate matrix.

For off-diagonal parameterization (diag_probs=FALSE):
\itemize{
\item Expects K*(K-1) parameters in row-major order excluding diagonal
\item Example K=3: [p12, p13, p21, p23, p31, p32]
}

For diagonal parameterization (diag_probs=TRUE):
\itemize{
\item Expects K parameters representing diagonal persistence probabilities
\item Example K=3: [p11, p22, p33]
}
}

\examples{
# Off-diagonal parameterization (default)
transition_matrix(c(0.3, 0.2), diag_probs = FALSE)  # 2x2 matrix

# Diagonal parameterization (original simulation.R style)
transition_matrix(c(0.8, 0.9), diag_probs = TRUE)   # 2x2 matrix with p11=0.8, p22=0.9
}
